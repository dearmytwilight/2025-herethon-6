{% load static %}

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‘ì„± í˜ì´ì§€</title>
  <link rel="stylesheet" href="{% static 'css/common/container.css' %}">
  <link rel="stylesheet" href="{% static 'css/write.css' %}">
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="back">
        <a href="#"><img src="../img/arrow_back.png" alt="ë’¤ë¡œê°€ê¸°"></a>
      </div>
      <div class="profile">
        <div class="img">
          <img src="../img/Group 59.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
        </div>
        <div class="name"><p>ë°”ê·¸ë°”ê·¸</p></div>
      </div>
      <div class="category">
        <img src="../img/Group 85.png" id="categoryIcon" alt="ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜"> 
        <div id="selectedCategory" class="hidden"></div>
        <div class="category-box hidden" id="categoryBox">
          <img src="../img/Group 86.png" alt="ì¹´í…Œê³ ë¦¬ ë°°ê²½" class="category-bg">
          <ul class="category-menu" id="categoryMenu">
            <li data-id="1">ì—°ì• </li>
            <li data-id="2">ì¸ê°„ê´€ê³„</li>
            <li data-id="3">ì·¨ì—…/ì»¤ë¦¬ì–´</li>
            <li data-id="4">ê±´ê°•</li>
            <li data-id="5">í•™ì—…</li>
            <li data-id="6">ì·¨ë¯¸</li>
            <li data-id="7">ì†Œë¹„</li>
            <li data-id="8">ê¸°íƒ€</li>
          </ul>
        </div>
      </div>
    </div>
    <!--
    <div class="image">
      <img src="../img/add_photo_alternate.png" alt="ì‚¬ì§„ ì¶”ê°€" id="imageBtn">
      <div class="image-box hidden" id="imageBox">
        <div class="dropdown-btn" id="dropdownBtn">ìµœê·¼ ì´ë¯¸ì§€ â–¼</div>
        <ul class="dropdown-menu hidden" id="dropdownMenu">
          <li>ì¦ê²¨ì°¾ëŠ” í•­ëª©</li>
          <li>ë¹„ë””ì˜¤</li>
          <li>ì…€í”¼</li>
          <li>ì¸ë¬¼ì‚¬ì§„</li>
          <li>íƒ€ì„ë©ìŠ¤</li>
          <li>ìŠ¤í¬ë¦°ìƒ·</li>
          <li>í™”ë©´ê¸°ë¡</li>
        </ul>
      </div>
    </div>
  -->
    <form method="POST" action="http://127.0.0.1:8000/moments/create/" enctype="multipart/form-data">
      <div class="input1">
        <p>ì œëª©</p>
        <input type="text" id="title" name="title">
      </div>
      <input type="hidden" name="category_id" id="categoryIdInput">
      <div class="input2">
        <p>ì‹¤íŒ¨ë‹´</p>
        <textarea id="failure"  name="content"></textarea>
      </div>
      <div class="input3">
        <p>ë‚´ê°€ ë§Œì•½ ë‹¤ì‹œ ëŒì•„ê°„ë‹¤ë©´?</p>
        <textarea id="regret" name="if_content"></textarea>
      </div>
      <div class="input4">
        <p>ì´ë¯¸ì§€ ì²¨ë¶€</p>
        <input type="file" name="images" accept="image/*" multiple>
      </div>
      <div class="button">
        <button type="submit">ì‘ì„±í•˜ê¸°</button>
      </div>
    </form>
  </div>

<script>
  // 1. ì¹´í…Œê³ ë¦¬ ê´€ë ¨ ìš”ì†Œ ì„ íƒ
  const icon = document.getElementById("categoryIcon");
  const box = document.getElementById("categoryBox");
  const menu = document.getElementById("categoryMenu");
  const selectedText = document.getElementById("selectedCategory");
  const categoryIdInput = document.getElementById("categoryIdInput"); // ğŸ’¡ hidden input

  // 2. ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ í´ë¦­ ì‹œ ë©”ë‰´ í† ê¸€
  icon.addEventListener("click", () => {
    box.classList.toggle("hidden");
  });

  // 3. ì¹´í…Œê³ ë¦¬ ë©”ë‰´ í´ë¦­ ì‹œ í…ìŠ¤íŠ¸ ë° ID ì„¤ì •
  menu.addEventListener("click", (e) => {
    if (e.target.tagName === "LI") {
      const selectedName = e.target.textContent;
      const selectedId = e.target.getAttribute("data-id");

      selectedText.textContent = selectedName;
      selectedText.classList.remove("hidden");
      box.classList.add("hidden");

      // hidden inputì— ID ì €ì¥
      categoryIdInput.value = selectedId;
    }
  });

  // 4. ì´ë¯¸ì§€ ë©”ë‰´ ê´€ë ¨ ìš”ì†Œ
  const imageBtn = document.getElementById("imageBtn");
  const imageBox = document.getElementById("imageBox");

  imageBtn.addEventListener("click", () => {
    imageBox.classList.toggle("hidden");
    dropdownMenu.classList.add("hidden");
  });

  // 5. ë“œë¡­ë‹¤ìš´ í† ê¸€
  const dropdownBtn = document.getElementById("dropdownBtn");
  const dropdownMenu = document.getElementById("dropdownMenu");

  dropdownBtn.addEventListener("click", () => {
    dropdownMenu.classList.toggle("hidden");
  });

  // 6. ë“œë¡­ë‹¤ìš´ ì„ íƒ ì‹œ í…ìŠ¤íŠ¸ ë³€ê²½
  dropdownMenu.addEventListener("click", (e) => {
    if (e.target.tagName === "LI") {
      dropdownBtn.textContent = e.target.textContent + " â–¼";
      dropdownMenu.classList.add("hidden");
    }
  });

    const form = document.querySelector("form");
  form.addEventListener("submit", function (e) {
    if (!categoryIdInput.value) {
      alert("ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
      e.preventDefault();  // ì œì¶œ ë§‰ê¸°
    }
  });
</script>

</body>
</html>
